-- üßë‚Äçüíº Usu√°rios (admin, m√©dico, paciente)
CREATE TABLE tb_usuario (
  pk_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  ds_nome VARCHAR(100) NOT NULL,
  ds_email VARCHAR(100) UNIQUE NOT NULL,
  ds_senha VARCHAR(255) NOT NULL,
  ds_tipo VARCHAR(20) NOT NULL, -- 'admin', 'medico', 'paciente'
  tg_ativo BOOLEAN DEFAULT TRUE
);

-- üßë‚Äç‚öïÔ∏è M√©dicos
CREATE TABLE tb_medico (
  pk_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  fk_usuario BIGINT NOT NULL,
  ds_crm VARCHAR(20) NOT NULL,
  ds_especialidade VARCHAR(50) NOT NULL,
  FOREIGN KEY (fk_usuario) REFERENCES tb_usuario(pk_id)
);

-- üë§ Pacientes
CREATE TABLE tb_paciente (
  pk_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  fk_usuario BIGINT NOT NULL,
  dt_nascimento DATE,
  ds_telefone VARCHAR(20),
  ds_rg VARCHAR(20),
  FOREIGN KEY (fk_usuario) REFERENCES tb_usuario(pk_id)
);

-- üìÖ Consultas
CREATE TABLE tb_consulta (
  pk_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  fk_medico BIGINT NOT NULL,
  fk_paciente BIGINT NOT NULL,
  dt_hora DATETIME NOT NULL,
  ds_status VARCHAR(20) NOT NULL DEFAULT 'confirmada', -- confirmada, realizada, faltou, cancelada
  FOREIGN KEY (fk_medico) REFERENCES tb_medico(pk_id),
  FOREIGN KEY (fk_paciente) REFERENCES tb_paciente(pk_id)
);

-- üìÇ Prontu√°rio
CREATE TABLE tb_prontuario (
  pk_id BIGINT PRIMARY KEY AUTO_INCREMENT,
  fk_consulta BIGINT NOT NULL,
  ds_diagnostico TEXT,
  ds_receita TEXT,
  ds_exames TEXT,
  dt_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (fk_consulta) REFERENCES tb_consulta(pk_id)
);
